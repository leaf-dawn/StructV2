<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DEMO</title>
    <style>
        * {
            padding: 0;
            margin: 0;
            user-select: none;
        }
        
        .container {
            background-color: #fafafa;
            border: 1px solid #ccc;
            position: relative;
        }
        
        .down {
            display: flex;
            margin-top: 20px;
        }
        
        #container {
            width: 100%;
            height: 500px;
            position: relative;
            overflow: hidden;
        }
        
    </style>
</head>

<body>
    <div class="container" id="container">
    </div>

    <button id="btn-prev">prev</button>
    <button id="btn-next">next</button>
    <button id="resize">resize</button>
    <button id="relayout">relayout</button>
    <button id="switch-mode">switch mode</button>
    <button id="brush-select">brush-select</button>
    <button id="toggle-center">Toggle Center</button>
    <span id="pos"></span>

    <script src="./../dist/sv.js"></script>
    <script>
        const Group = SV.Group,
            Bound = SV.Bound,
            G6 = SV.G6,
            Vector = SV.Vector;
    </script>
    <script src="./Layouter/LinkList.js"></script>
    <script src="./Layouter/BinaryTree.js"></script>
    <script src="./Layouter/TriTree.js"></script>
    <script src="./Layouter/Stack.js"></script>
    <script src="./Layouter/LinkQueue.js"></script>
    <script src="./Layouter/GeneralizedList.js"></script>
    <script src="./Layouter/ChainHashTable.js"></script>
    <script src="./Layouter/Array.js"></script>
    <script src="./Layouter/BarChart.js"></script>
    <script src="./Layouter/HashTable.js"></script>
    <script src="./Layouter/LinkStack.js"></script>
    <script src="./Layouter/AdjoinMatrixGraph.js"></script>
    <script src="./Layouter/AdjoinTableGraph.js"></script>
    <script src="./Layouter/SqQueue.js"></script>
    <script src="./Layouter/PTree.js"></script>
    <script src="./Layouter/PCTree.js"></script>
    <script src="./Layouter/Force.js"></script>
    <script src="./Layouter/IndentedTree.js"></script>
    <script src="./data.js"></script>

    <script>
        let isForce = false;

        let dataIndex = 0;
        curData = SOURCES_DATA[dataIndex];
        // 判断是否需要力导向布局
        Object.keys(curData).forEach(key => {
            if(curData[key].layouter === "Force")    isForce = true;
        });
        
        // 配置选项，可以控制图像是否自动居中
        let engineOptions = {
            view: {
                groupPadding: 40,
                fitCenter: true, // 设置为 false 可以禁用自动居中
            },
        };
        
        let cur = SV(document.getElementById('container'), engineOptions, isForce);

        let enableBrushSelect = false;

        const container = document.getElementById('container'),
            pos = document.getElementById('pos');

        cur.render(curData);

        document.getElementById('btn-next').addEventListener('click', e => {
            curData = SOURCES_DATA[++dataIndex];
            cur.render(curData);
        });

        document.getElementById('btn-prev').addEventListener('click', e => {
            curData = SOURCES_DATA[--dataIndex];
            cur.render(curData);
        });

        document.getElementById('resize').addEventListener('click', e => {
            container.style.height = 800 + 'px';
            cur.resize(container.offsetWidth, container.offsetHeight);
        });

        document.getElementById('relayout').addEventListener('click', e => {
            cur.reLayout();
        });

        document.getElementById('switch-mode').addEventListener('click', e => {
            cur.updateStyle('Array', newArrayOption);
        });

        document.getElementById('brush-select').addEventListener('click', e => {
            enableBrushSelect = !enableBrushSelect;
            cur.switchBrushSelect(enableBrushSelect);
        });

        // 新增：切换居中功能的按钮
        document.getElementById('toggle-center').addEventListener('click', e => {
            // 重新创建引擎实例来应用新的配置
            engineOptions.view.fitCenter = !engineOptions.view.fitCenter;
            cur = SV(document.getElementById('container'), engineOptions, isForce);
            cur.render(curData);
            console.log('fitCenter:', engineOptions.view.fitCenter);
        });

        // -------------------------------------------------------------------------------------------------------

        container.addEventListener('mousemove', e => {
            let x = e.offsetX,
                y = e.offsetY;
            pos.innerHTML = `${x},${y}`;
        });
    </script>
</body>

</html>